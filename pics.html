<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>

	<!-- Meta tags -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<!-- Page title -->
	<title>Web QE Demo App</title>

	<!-- And favicon -->
	<link rel="icon" type="image/png" href="data:image/png;base64, foobar" />

	<!-- Style sheets -->
	<link rel="stylesheet" href="css/style.css" />
	<link rel="stylesheet" href="css/addon.css" />

	<!-- Add web fonts -->
	<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans+Condensed:300" />

	<!-- Polyfil for IE -->
	<!--[if lt IE 9]>
	<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

	<!-- Lastly, scripts -->

</head>

<body>

	<nav>
		<h1 id="title"><a href="index.html">Web QE Demo App</a></h1>
	</nav>

	<div id="infosearch">
		Would you like to see pictures of:<br />
		<input type="text" id="search" placeholder="Query">
	</div>

	<section id="content">
	</section>

	<!-- Lazy Loadable JS -->
	<script>
		// Select the input & set focus on it at start
		var input = document.getElementById("search");
		input.focus();

		// Call for action when pressed enter to search
		input.onkeyup = function (event) {
			if (event.keyCode === 13) getInfo(input.value);
		}

		// Tell what to do, when called for action
		function getInfo (query) {
			var container = document.getElementById("content");

			// If no inputs provided, let the user know & exit
			if (!query) {
				container.innerHTML = "Firing blanks, eh!";
				return;
			}

			// Let the user know about working the magic
			container.innerHTML = "Loading...";

			// Fetch data & on success process & append it
			var request = new XMLHttpRequest();
			var endpoint = "https://api.flickr.com/services/rest/?"
							+ "method=flickr.photos.search&api_key=c9d1d33ffc3d34dbbddc28093b8c2f95"
							+ "&text="+ encodeURIComponent(query)
							+ "&extras=owner_name%2Curl_q&per_page=8&format=json&nojsoncallback=1";
			request.onload = function () {
				var response = JSON.parse(this.responseText);

				var content = "";

				for (var i in response.photos.photo) {
					var url =	[
									"http://flickr.com/photos",
									response.photos.photo[i].owner,
									response.photos.photo[i].id,
								].join("/")
					, anchor = [
									"<a class='imgthumb' href='", url,
									"' id='", response.photos.photo[i].id,
									"' target='_blank'><img src='",
									unescape(response.photos.photo[i].url_q),
									"' title='",
									response.photos.photo[i].title,
									"' /><div class='credit'>by: ",
									response.photos.photo[i].ownername,
									"</div></a>"
								].join("");

					content += (anchor);
				};

				container.innerHTML = content;
			}
			request.open("get", endpoint, true);
			request.send();
		}
	</script>

</body>

</html>
