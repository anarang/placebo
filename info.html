<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>

	<!-- Meta tags -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<!-- Page title -->
	<title>Web QE Demo App</title>

	<!-- And favicon -->
	<link rel="icon" type="image/png" href="data:image/png;base64, foobar" />

	<!-- Style sheets -->
	<link rel="stylesheet" href="css/style.css" />
	<link rel="stylesheet" href="css/addon.css" />

	<!-- Add web fonts -->
	<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans+Condensed:300" />

	<!-- Polyfil for IE -->
	<!--[if lt IE 9]>
	<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

	<!-- Lastly, scripts -->
	<script src="js/mediawiki.js"></script>

</head>

<body>

	<nav>
		<h1 id="title"><a href="index.html">Web QE Demo App</a></h1>
	</nav>

	<div id="infosearch">
		Would you like to know about:<br />
		<input type="text" id="search" placeholder="Query">
	</div>

	<section id="content">
	</section>

	<!-- Lazy Loadable JS -->
	<script>
		// Select the input & set focus on it at start
		var input = document.getElementById("search");
		input.focus();

		// Call for action when pressed enter to search
		input.onkeyup = function (event) {
			if (event.keyCode === 13) getInfo(input.value);
		}

		// Tell what to do, when called for action
		function getInfo (query) {
			var container = document.getElementById("content");

			// If no inputs provided, let the user know & exit
			if (!query) {
				container.innerHTML = "Firing blanks, eh!";
				return;
			}

			// Let the user know about working the magic
			container.innerHTML = "Loading...";

			// Fetch data & on success process & append it
			var wiki = MediaWikiJS('https://en.wikipedia.org');
			wiki.send({
				action: 'query',
				prop: 'revisions',
				rvprop: "content",
				rvsection: 0,
				rvparse: 1,
				titles: query
			}, function (data) {
				var pages = data.query.pages;
				content = (pages[Object.keys(pages)[0]]
					.revisions[0]["*"]).split('href="/')
					.join('href="http://en.wikipedia.org/');
				container.innerHTML = content;
			});
		}
	</script>

</body>

</html>
