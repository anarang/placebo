<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>

	<!-- Meta tags -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<!-- Page title -->
	<title>Web QE Demo App</title>

	<!-- And favicon -->
	<link rel="icon" type="image/png" href="data:image/png;base64, foobar" />

	<!-- Style sheets -->
	<link rel="stylesheet" href="css/style.css" />
	<link rel="stylesheet" href="css/addon.css" />

	<!-- Add web fonts -->
	<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans+Condensed:300" />

	<!-- Polyfil for IE -->
	<!--[if lt IE 9]>
	<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

	<!-- Lastly, scripts -->

</head>

<body>

	<nav>
		<h1 id="title"><a href="index.html">Web QE Demo App</a></h1>
	</nav>

	<div id="infosearch">
		Would you like to know about:<br />
		<input type="text" id="search" placeholder="Query">
	</div>

	<section id="content">
	</section>

	<!-- Lazy Loadable JS -->
	<script>
		// Select the input & set focus on it at start
		var input = document.getElementById("search");
		input.focus();

		// Call for action when pressed enter to search
		input.onkeyup = function (event) {
			if (event.keyCode === 13) getInfo(input.value);
		}

		// Tell what to do, when called for action
		function getInfo (query) {
			var container = document.getElementById("content");

			// If no inputs provided, let the user know & exit
			if (!query) {
				container.innerHTML = "Firing blanks, eh!";
				return;
			}

			// Let the user know about working the magic
			container.innerHTML = "Loading...";

			// Fetch data & on success process & append it
			var request = new XMLHttpRequest();
			var endpoint = "http://gdata.youtube.com/feeds/api/videos?q="
							+ query.split(" ").join("+")
							+ "&max-results=10&v=2&alt=json";
			request.onload = function () {
				var response = JSON.parse(this.responseText),
						videos = response.feed.entry,
						content = "";

				for (var i in videos) {
					var url = videos[i].link[0].href.split("&feature=youtube_gdata")[0],
							id = videos[i].id.$t.split("video:")[1],
							thumb = videos[i].media$group.media$thumbnail[0].url,
							title = videos[i].title.$t,
							credit = videos[i].media$group.media$credit[0].$t,
							item = [
									"<a class='vidthumb' href='", url,
									"' id='", id,
									"' target='_blank'><img src='", thumb,
									"' title='", title,
									"' /><div class='credit'>by: ", credit,
									"</div></a>"
								].join("");

					content += item;
				}

				container.innerHTML = content;
			}
			request.open("get", endpoint, true);
			request.send();
		}
	</script>

</body>

</html>
